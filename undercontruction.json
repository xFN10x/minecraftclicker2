{"turbo":false,"interpolation":true,"framerate":60,"highQualityPen":true,"maxClones":9999999999,"fencing":false,"miscLimits":false,"dangerousOptimizations":false,"stageWidth":480,"stageHeight":360,"resizeMode":"dynamic-resize","autoplay":true,"username":"player####","closeWhenStopped":true,"projectId":"p4-@undercontruction.pmp","custom":{"css":"","js":""},"appearance":{"background":"#000000","foreground":"#ffffff","accent":"#00c3ff"},"loadingScreen":{"progressBar":false,"text":"","imageMode":"normal","image":null},"controls":{"greenFlag":{"enabled":false},"stopAll":{"enabled":false},"fullscreen":{"enabled":false},"pause":{"enabled":false}},"monitors":{"editableLists":false,"variableColor":"#ff8c1a","listColor":"#fc662c"},"penguinmod":{"permissionManager":{"enabled":false,"unsandboxedJavascript":false}},"compiler":{"enabled":true,"warpTimer":false},"packagedRuntime":true,"target":"html","app":{"icon":null,"packageName":"undercontruction","windowTitle":"Under Contruction!","windowMode":"window","version":"1.0.0"},"chunks":{"gamepad":false,"pointerlock":false},"cloudVariables":{"mode":"ws","cloudHost":"wss://clouddata.turbowarp.org","custom":{},"specialCloudBehaviors":false,"unsafeCloudBehaviors":false},"cursor":{"type":"auto","custom":null,"center":{"x":0,"y":0}},"extensions":["data:application/javascript,class%20SPtest2%7BgetInfo()%7Breturn%7Bid%3A%22SPtest%22%2Cname%3A%22Obj%20Filt%22%2Cblocks%3A%5B%7Bopcode%3A%22filterJson%22%2Ctext%3A%22filter%20JSON%20%5BOBJ%5D%20with%20string%20%5BSTR%5D%22%2CblockType%3AScratch.BlockType.REPORTER%2Carguments%3A%7BOBJ%3A%7Btype%3AScratch.ArgumentType.STRING%7D%2CSTR%3A%7Btype%3AScratch.ArgumentType.STRING%7D%7D%7D%2C%7Bopcode%3A%22orderJson%22%2Ctext%3A%22order%20JSON%20%5BOBJ%5D%20with%20string%20%5BSTR%5D%22%2CblockType%3AScratch.BlockType.REPORTER%2Carguments%3A%7BOBJ%3A%7Btype%3AScratch.ArgumentType.STRING%7D%2CSTR%3A%7Btype%3AScratch.ArgumentType.STRING%7D%7D%7D%2C%7Bopcode%3A%22typeString%22%2Ctext%3A%22%5BSTRING1%5D%20%7C%7C%20%5BSTRING2%5D%22%2CblockType%3AScratch.BlockType.REPORTER%2Carguments%3A%7BSTRING1%3A%7Btype%3AScratch.ArgumentType.STRING%7D%2CSTRING2%3A%7Btype%3AScratch.ArgumentType.STRING%7D%7D%7D%2C%7Bopcode%3A%22exportME%22%2Ctext%3A%22my%20skin%20data%22%2CblockType%3AScratch.BlockType.REPORTER%7D%2C%7Bopcode%3A%22prompt%22%2Ctext%3A%22prompt%20%5BSTR%5D%22%2CblockType%3AScratch.BlockType.REPORTER%2Carguments%3A%7BSTR%3A%7Btype%3AScratch.ArgumentType.STRING%7D%7D%7D%2C%7Bopcode%3A%22goToLink%22%2CblockType%3AScratch.BlockType.COMMAND%2Ctext%3A%22open%20link%20%5BINPUT%5D%22%2Carguments%3A%7BINPUT%3A%7Btype%3AScratch.ArgumentType.STRING%7D%7D%7D%2C%7Bopcode%3A%22redirectToLink%22%2CblockType%3AScratch.BlockType.COMMAND%2Ctext%3A%22redirect%20to%20%5BINPUT%5D%22%2Carguments%3A%7BINPUT%3A%7Btype%3AScratch.ArgumentType.STRING%7D%7D%7D%2C%7Bopcode%3A%22setQual%22%2CblockType%3AScratch.BlockType.COMMAND%2Ctext%3A%22set%20qual%20to%20%5BVAL%5D%22%2Carguments%3A%7BVAL%3A%7Btype%3AScratch.ArgumentType.NUMBER%7D%7D%7D%2C%5D%7D%7DfilterJson(e)%7Breturn%20JSON.stringify(function%20t(r)%7Bif(%22object%22%3D%3Dtypeof%20r%26%26null!%3D%3Dr)%7Blet%20n%3D%7B%7D%3Bfor(let%5Bo%2Ca%5Dof%20Object.entries(r))if(String(o).toLowerCase().includes(e.STR.toLowerCase())%7C%7C%22string%22%3D%3Dtypeof%20a%26%26a.toLowerCase().includes(e.STR.toLowerCase()))n%5Bo%5D%3Da%3Belse%20if(%22object%22%3D%3Dtypeof%20a)%7Blet%20i%3Dt(a)%3BObject.keys(i).length%3E0%26%26(n%5Bo%5D%3D%7B...a%2C...i%7D)%7Dreturn%20n%7Dreturn%20Array.isArray(r)%3Fr.map(e%3D%3Et(e)).filter(e%3D%3E%22object%22%3D%3Dtypeof%20e%26%26Object.keys(e).length%3E0)%3Ar%7D(JSON.parse(e.OBJ)%7C%7C%7B%7D)%2Cnull%2C2)%7DorderJson(e)%7Blet%7Bmatching%3At%2CnonMatching%3Ar%7D%3Dfunction%20t(r)%7Blet%20n%3D%7B%7D%2Co%3D%7B%7D%3Bif(%22object%22%3D%3Dtypeof%20r%26%26null!%3D%3Dr)for(let%5Ba%2Ci%5Dof%20Object.entries(r))if(String(a).toLowerCase().includes(e.STR.toLowerCase())%7C%7C%22string%22%3D%3Dtypeof%20i%26%26i.toLowerCase().includes(e.STR.toLowerCase()))n%5Ba%5D%3Di%3Belse%20if(%22object%22%3D%3Dtypeof%20i)%7Blet%7Bmatching%3Al%2CnonMatching%3Ap%7D%3Dt(i)%3BObject.keys(l).length%3E0%26%26(n%5Ba%5D%3D%7B...i%2C...l%7D)%2CObject.keys(p).length%3E0%26%26(o%5Ba%5D%3D%7B...i%2C...p%7D)%7Delse%20o%5Ba%5D%3Di%3Belse%20Array.isArray(r)%3Fr.forEach((e%2Cr)%3D%3E%7Blet%7Bmatching%3Aa%2CnonMatching%3Ai%7D%3Dt(e)%3BObject.keys(a).length%3E0%26%26(n%5Br%5D%3D%7B...e%2C...a%7D)%2CObject.keys(i).length%3E0%26%26(o%5Br%5D%3D%7B...e%2C...i%7D)%7D)%3Ao.value%3Dr%3Breturn%7Bmatching%3An%2CnonMatching%3Ao%7D%7D(JSON.parse(e.OBJ)%7C%7C%7B%7D)%3Breturn%20JSON.stringify(%7B...t%2C...r%7D%2Cnull%2C2)%7DgoToLink(e)%7BScratch.openWindow(e.INPUT)%7DredirectToLink(e)%7BScratch.redirect(e.INPUT)%7Dprompt(e)%7Breturn%20window.prompt(e.STR)%7DtypeString(e)%7Breturn%20e.STRING1%7C%7Ce.STRING2%7DexportME(e%2Ct)%7Bif(-1%3D%3D%3Dvm.renderer._drawList.indexOf(t.target.drawableID))return%22%22%3Blet%20r%3Dvm.runtime.renderer.extractDrawableScreenSpace(t.target.drawableID).imageData%3Bvar%20n%3Ddocument.createElement(%22canvas%22)%3Breturn%20n.width%3Dr.width%2Cn.height%3Dr.height%2Cn.getContext(%222d%22).putImageData(r%2C0%2C0)%2Cthis.stretch(n.toDataURL(%22image%2Fpng%22)%2C1.61*r.width%2C1.61*r.height)%7Dstretch(e%2Ct%2Cr)%7Breturn%20new%20Promise(n%3D%3E%7Blet%20o%3Dnew%20Image%3Bo.onload%3D()%3D%3E%7Bn(this.exportImg(o%2Cthis.printImg(o%2Ct%2Cr)%2Ct%2Cr))%7D%2Co.src%3De%7D)%7DprintImg(e%2Ct%2Cr)%7Blet%20n%3Ddocument.createElement(%22canvas%22)%3Bn.width%3Dt%7C%7Ce.width%2Cn.height%3Dr%7C%7Ce.height%3Blet%20o%3Dn.getContext(%222d%22)%3Breturn%20o.drawImage(e%2C0%2C0%2Cn.width%2Cn.height)%2Co.getImageData(0%2C0%2Cn.width%2Cn.height).data%7DexportImg(e%2Ct%2Cr%2Cn)%7Blet%20o%3Ddocument.createElement(%22canvas%22)%3Breturn%20o.width%3Dr%7C%7Ce.width%2Co.height%3Dn%7C%7Ce.height%2Co.getContext(%222d%22).putImageData(new%20ImageData(new%20Uint8ClampedArray(t)%2Co.width%2Co.height)%2C0%2C0)%2Co.toDataURL()%7DsetQual(e%2Ct)%7Blet%20r%3Dvm.renderer._allDrawables%5Bt.target.drawableID%5D%3Br.setHighQuality(!0)%2Cr.skin._maxTextureScale%3DScratch.Cast.toNumber(e.VAL)%2Cr.skin.emitWasAltered()%7D%7DScratch.extensions.register(new%20SPtest2)%3B","data:application/javascript,!function(t)%7B%22use%20strict%22%3Blet%20e%3Dt.ArgumentType%2Ci%3Dt.BlockType%2Cr%3Dt.Cast%3Bt.extensions.register(new%20class%20t%7Bconstructor()%7Bthis.failed%3D!1%2Cthis.error%3D%22%22%2Cthis.waiting%3D!1%2Cthis.origin%3D%22%22%2Cwindow.addEventListener(%22message%22%2Ct%3D%3E%7Bthis.handleWindowMessage(t)%7D)%2Cthis._possibleErrors%3D%7BnoParents%3A%22No%20parent%20window%22%2CtimedOut%3A%22Timed%20out%22%2CnotTrusted%3A%22Your%20website%20is%20not%20trusted%22%2CcouldntLoad%3A%22Extension%20failed%20to%20load%5Cn%22%2CnoExt%3A%22No%20extension%20URL%20was%20provided%22%2CnotString%3A%22Extension%20URL%20was%20not%20a%20string%22%7D%7DgetInfo()%7Breturn%7Bid%3A%22jgExtGalleryLoader%22%2Cname%3A%22Gallery%20Extension%20Loader%22%2Cblocks%3A%5B%7BblockType%3Ai.LABEL%2Ctext%3A%22Editor%20Origin%20must%20be%20set%20before%20use.%22%7D%2C%7BblockType%3Ai.LABEL%2Ctext%3A'Editor%20Origin%20will%20be%20the%20%22window.origin%22'%7D%2C%7BblockType%3Ai.LABEL%2Ctext%3A%22of%20the%20editor%20window.%22%7D%2C%7Bopcode%3A%22setExpectingURL%22%2CblockType%3Ai.COMMAND%2Ctext%3A%22set%20editor%20origin%20to%20%5BURL%5D%22%2Carguments%3A%7BURL%3A%7Btype%3Ae.STRING%2CdefaultValue%3A%22https%3A%2F%2Fstudio.penguinmod.com%22%7D%7D%7D%2C%7Bopcode%3A%22loadFromURL%22%2CblockType%3Ai.COMMAND%2Ctext%3A%22request%20to%20load%20extension%20url%20%5BURL%5D%22%2Carguments%3A%7BURL%3A%7Btype%3Ae.STRING%2CdefaultValue%3A%22https%3A%2F%2Fextensions.turbowarp.org%2Fstretch.js%22%7D%7D%7D%2C%22---%22%2C%7Bopcode%3A%22getwaiting%22%2CblockType%3Ai.BOOLEAN%2Ctext%3A%22waiting%3F%22%7D%2C%7Bopcode%3A%22getfailed%22%2CblockType%3Ai.BOOLEAN%2Ctext%3A%22failed%3F%22%7D%2C%7Bopcode%3A%22geterror%22%2CblockType%3Ai.REPORTER%2Ctext%3A%22error%22%7D%2C%5D%7D%7DhandleWindowMessage(t)%7Bif(!t.origin.startsWith(this.origin)%7C%7C!t.data%7C%7C!t.data.p4)return%3Blet%20e%3Dt.data.p4%3Bif(e.type)%7Bif(this.waiting%3D!1%2C%22success%22%3D%3D%3De.type)%7Bconsole.log(%22Loading%20extension%20was%20a%20success%22)%2Cthis.failed%3D!1%2Cthis.error%3D%22%22%3Breturn%7Dswitch(console.log(%22Loading%20extension%20failed%22)%2Cthis.failed%3D!0%2Ce.error)%7Bcase%22not_trusted%22%3Athis.error%3Dthis._possibleErrors.notTrusted%3Bbreak%3Bcase%22no_loadExt%22%3Athis.error%3Dthis._possibleErrors.noExt%3Bbreak%3Bcase%22not_string%22%3Athis.error%3Dthis._possibleErrors.notString%3Bbreak%3Bcase%22couldnt_load%22%3Athis.error%3Dthis._possibleErrors.couldntLoad%2Be.pmerror%3Bbreak%3Bdefault%3Athis.error%3De.error%7D%7D%7DsetExpectingURL(t)%7Bthis.origin%3Dr.toString(t.URL)%7DloadFromURL(t)%7Bif(%22O%25Lu4%3Auu%5DX%23B%7D%7Bq8PWYW%22!%3D%3Dvm.runtime.targets%5B0%5D.id%7C%7Cthis.waiting)return%3Bthis.waiting%3D!1%3Blet%20e%3Dr.toString(t.URL)%2Ci%3Dwindow.opener%7C%7Cwindow.parent%3Bif(!i)%7Bthis.failed%3D!0%2Cthis.error%3Dthis._possibleErrors.noParents%3Breturn%7Dthis.waiting%3D!0%2CsetTimeout(()%3D%3E%7Bthis.waiting%26%26(this.waiting%3D!1%2Cthis.failed%3D!0%2Cthis.error%3Dthis._possibleErrors.timedOut)%7D%2C2500)%2Ci.postMessage(%7BloadExt%3Ae%7D%2Cthis.origin)%7Dgetwaiting()%7Breturn%20this.waiting%7Dgetfailed()%7Breturn%20this.failed%7Dgeterror()%7Breturn%20this.error%7D%7D)%7D(Scratch)%3B","data:text/javascript;base64,Ly8gTmFtZTogRHJvcGRvd24gTWFrZXIKLy8gSUQ6IFNQMHpNZW51TWFrZXIKLy8gRGVzY3JpcHRpb246IENyZWF0ZSBDdXN0b20gRHJvcGRvd25zCi8vIEJ5OiBTaGFya1Bvb2wKLy8gQnk6IDB6bnp3IDxodHRwczovL3NjcmF0Y2gubWl0LmVkdS91c2Vycy8wem56dy8+Ci8vIEJ5OiBDU1QxMjI5IDxodHRwczovL3NjcmF0Y2gubWl0LmVkdS91c2Vycy9DU1QxMjI5Lz4KLy8gTGljZW5zZTogTUlUIEFORCBMR1BMdjMKCi8vIFZlcnNpb24gVi4xLjAuMDEKCihmdW5jdGlvbiAoU2NyYXRjaCkgewogICJ1c2Ugc3RyaWN0IjsKICBpZiAoIVNjcmF0Y2guZXh0ZW5zaW9ucy51bnNhbmRib3hlZCkgdGhyb3cgbmV3IEVycm9yKCJNZW51IE1ha2VyIG5lZWRzIHRvIHJ1biB1bnNhbmRib3hlZCEiKTsKCiAgY29uc3QgZGVsZXRlU1ZHID0KICAgICJkYXRhOmltYWdlL3N2Zyt4bWw7YmFzZTY0LFBITjJaeUI0Yld4dWN6MGlhSFIwY0RvdkwzZDNkeTUzTXk1dmNtY3ZNakF3TUM5emRtY2lJSGRwWkhSb1BTSXpPUzQzTXpZaUlHaGxhV2RvZEQwaU16a3VOek0ySWlCMmFXVjNRbTk0UFNJd0lEQWdNemt1TnpNMklETTVMamN6TmlJK1BIQmhkR2dnWkQwaVRURXlMalUwTVNBek5TNHhPVFZoT0NBNElEQWdNQ0F4TFRndE9GWXhNaTQxTkRGaE9DQTRJREFnTUNBeElEZ3RPR2d4TkM0Mk5UUmhPQ0E0SURBZ01DQXhJRGdnT0hZeE5DNDJOVFJoT0NBNElEQWdNQ0F4TFRnZ09Ib2lJR1pwYkd3OUlpTm1aalJrTkdRaUx6NDhjR0YwYUNCa1BTSk5NQ0F6T1M0M016WldNR2d6T1M0M016WjJNemt1TnpNMmVpSWdabWxzYkQwaWJtOXVaU0l2UGp4d1lYUm9JR1E5SWsweE1pNDFOREVnTXpVdU1UazFZVGdnT0NBd0lEQWdNUzA0TFRoV01USXVOVFF4WVRnZ09DQXdJREFnTVNBNExUaG9NVFF1TmpVMFlUZ2dPQ0F3SURBZ01TQTRJRGgyTVRRdU5qVTBZVGdnT0NBd0lEQWdNUzA0SURoNklpQm1hV3hzUFNKdWIyNWxJaUJ6ZEhKdmEyVXRiM0JoWTJsMGVUMGlMakkxTVNJZ2MzUnliMnRsUFNJak1EQXdJaUJ6ZEhKdmEyVXRkMmxrZEdnOUlqVWlMejQ4Y0dGMGFDQmtQU0pOTVRNdU1UQTRJREl5TGpVNU9XRXlMalkzSURJdU5qY2dNQ0F3SURFdE1pNDJOeTB5TGpZM2RpMHVNVEl5WVRJdU5qY2dNaTQyTnlBd0lEQWdNU0F5TGpZM0xUSXVOamRvTVRNdU5USmhNaTQyTnlBeUxqWTNJREFnTUNBeElESXVOamNnTWk0Mk4zWXVNVEl5WVRJdU5qY2dNaTQyTnlBd0lEQWdNUzB5TGpZM0lESXVOamQ2SWlCbWFXeHNQU0lqWm1abUlpOCtQQzl6ZG1jKyI7CiAgY29uc3QgYWRkU1ZHID0KICAgICJkYXRhOmltYWdlL3N2Zyt4bWw7YmFzZTY0LFBITjJaeUI0Yld4dWN6MGlhSFIwY0RvdkwzZDNkeTUzTXk1dmNtY3ZNakF3TUM5emRtY2lJSGRwWkhSb1BTSXpPUzQzTXpZaUlHaGxhV2RvZEQwaU16a3VOek0ySWlCMmFXVjNRbTk0UFNJd0lEQWdNemt1TnpNMklETTVMamN6TmlJK1BIQmhkR2dnWkQwaVRURXlMalUwTVNBek5TNHhPVFZoT0NBNElEQWdNQ0F4TFRndE9GWXhNaTQxTkRGaE9DQTRJREFnTUNBeElEZ3RPR2d4TkM0Mk5UUmhPQ0E0SURBZ01DQXhJRGdnT0hZeE5DNDJOVFJoT0NBNElEQWdNQ0F4TFRnZ09Ib2lJR1pwYkd3OUlpTTFNbVptTTJVaUx6NDhjR0YwYUNCa1BTSk5NVEl1TlRReElETTFMakU1TldFNElEZ2dNQ0F3SURFdE9DMDRWakV5TGpVME1XRTRJRGdnTUNBd0lERWdPQzA0YURFMExqWTFOR0U0SURnZ01DQXdJREVnT0NBNGRqRTBMalkxTkdFNElEZ2dNQ0F3SURFdE9DQTRlaUlnWm1sc2JEMGlibTl1WlNJZ2MzUnliMnRsTFc5d1lXTnBkSGs5SWk0eU5URWlJSE4wY205clpUMGlJekF3TUNJZ2MzUnliMnRsTFhkcFpIUm9QU0kxSWk4K1BIQmhkR2dnWkQwaVRURXpMakV3T0NBeU1pNDFPVGxoTWk0Mk55QXlMalkzSURBZ01DQXhMVEl1TmpjdE1pNDJOM1l0TGpFeU1tRXlMalkzSURJdU5qY2dNQ0F3SURFZ01pNDJOeTB5TGpZM2FERXpMalV5WVRJdU5qY2dNaTQyTnlBd0lEQWdNU0F5TGpZM0lESXVOamQyTGpFeU1tRXlMalkzSURJdU5qY2dNQ0F3SURFdE1pNDJOeUF5TGpZM2VpSWdabWxzYkQwaUkyWm1aaUl2UGp4d1lYUm9JR1E5SWsweE55NHhNemNnTVRNdU1UQTRZVEl1TmpjZ01pNDJOeUF3SURBZ01TQXlMalkzTFRJdU5qZG9MakV5TW1FeUxqWTNJREl1TmpjZ01DQXdJREVnTWk0Mk55QXlMalkzZGpFekxqVXlZVEl1TmpjZ01pNDJOeUF3SURBZ01TMHlMalkzSURJdU5qZG9MUzR4TWpKaE1pNDJOeUF5TGpZM0lEQWdNQ0F4TFRJdU5qY3RNaTQyTjNvaUlHWnBiR3c5SWlObVptWWlMejQ4Y0dGMGFDQmtQU0pOTUNBek9TNDNNelpXTUdnek9TNDNNeloyTXprdU56TTJlaUlnWm1sc2JEMGlibTl1WlNJdlBqd3ZjM1puUGc9PSI7CiAgY29uc3QgZWRpdFNWRyA9CiAgICAiZGF0YTppbWFnZS9zdmcreG1sO2Jhc2U2NCxQSE4yWnlCNGJXeHVjejBpYUhSMGNEb3ZMM2QzZHk1M015NXZjbWN2TWpBd01DOXpkbWNpSUhkcFpIUm9QU0l6T1M0M016WWlJR2hsYVdkb2REMGlNemt1TnpNMklpQjJhV1YzUW05NFBTSXdJREFnTXprdU56TTJJRE01TGpjek5pSStQSEJoZEdnZ1pEMGlUVEV5TGpVME1TQXpOUzR4T1RWaE9DQTRJREFnTUNBeExUZ3RPRll4TWk0MU5ERmhPQ0E0SURBZ01DQXhJRGd0T0dneE5DNDJOVFJoT0NBNElEQWdNQ0F4SURnZ09IWXhOQzQyTlRSaE9DQTRJREFnTUNBeExUZ2dPSG9pSUdacGJHdzlJaU0wTUdRNFptWWlMejQ4Y0dGMGFDQmtQU0pOTVRJdU5UUXhJRE0xTGpFNU5XRTRJRGdnTUNBd0lERXRPQzA0VmpFeUxqVTBNV0U0SURnZ01DQXdJREVnT0MwNGFERTBMalkxTkdFNElEZ2dNQ0F3SURFZ09DQTRkakUwTGpZMU5HRTRJRGdnTUNBd0lERXRPQ0E0ZWlJZ1ptbHNiRDBpYm05dVpTSWdjM1J5YjJ0bExXOXdZV05wZEhrOUlpNHlOVEVpSUhOMGNtOXJaVDBpSXpBd01DSWdjM1J5YjJ0bExYZHBaSFJvUFNJMUlpOCtQSEJoZEdnZ1pEMGlUVEV5TGpVNE55QXlNeTR3T1RoakxqRXdNaTB1TkRNdU16YzNMUzQ0Tmk0M016UXRNUzR5TGpNeU1TMHVNekExSURRdU9ETTRJRFF1TVRZNElEUXVOVFE0SURRdU5EZ3pMUzR6TkRRdU16Y3pMUzQzT0RndU5qWXpMVEV1TWpNeExqYzJPR3d0TXk0NE5DNDVNVFpqTFM0NE1UY3VNVGswTFRFdU16SXhMUzR6TVMweExqRXlOeTB4TGpFeU5ucHRNVEV1TVRFNExURXdMakF6Tm1FeExqQTVOU0F4TGpBNU5TQXdJREFnTVNBd0xURXVOVFE0YkM0NU5qWXRMamsyTjJFeExqQTVOU0F4TGpBNU5TQXdJREFnTVNBeExqVTBPU0F3YkRJdU9UWTVJREl1T1RkakxqUXlOeTQwTWpjdU5ESTNJREV1TVRJZ01DQXhMalUwT0d3dExqazJOeTQ1TmpaaE1TNHdPVFVnTVM0d09UVWdNQ0F3SURFdE1TNDFORGdnTUhwdExUZ3VNemt4SURndU16a3hZVEV1TURrMUlERXVNRGsxSURBZ01DQXhJREF0TVM0MU5EaHNOaTR3TVMwMkxqQXhZVEV1TURrMUlERXVNRGsxSURBZ01DQXhJREV1TlRRNElEQnNNaTQ1TmprZ01pNDVOamxqTGpReU9DNDBNamd1TkRJNElERXVNVElnTUNBeExqVTBPR3d0Tmk0d01TQTJMakF4WVRFdU1EazFJREV1TURrMUlEQWdNQ0F4TFRFdU5UUTRJREI2SWlCbWFXeHNQU0lqWm1abUlpOCtQSEJoZEdnZ1pEMGlUVEFnTXprdU56TTJWakJvTXprdU56TTJkak01TGpjek5ub2lJR1pwYkd3OUltNXZibVVpTHo0OEwzTjJaejQ9IjsKICBjb25zdCBtZW51SWNvblVSSSA9CiAgICAiZGF0YTppbWFnZS9zdmcreG1sO2Jhc2U2NCxQSE4yWnlCNGJXeHVjejBpYUhSMGNEb3ZMM2QzZHk1M015NXZjbWN2TWpBd01DOXpkbWNpSUhkcFpIUm9QU0l4TURZdU5ERTVJaUJvWldsbmFIUTlJakV3Tmk0ME1Ua2lJSFpwWlhkQ2IzZzlJakFnTUNBeE1EWXVOREU1SURFd05pNDBNVGtpUGp4d1lYUm9JR1E5SWsweUxqVWdOVE11TWpGRE1pNDFJREkxTGpJd05DQXlOUzR5TURRZ01pNDFJRFV6TGpJeElESXVOWE0xTUM0M01TQXlNaTQzTURRZ05UQXVOekVnTlRBdU56RXRNakl1TnpBMElEVXdMamN4TFRVd0xqY3hJRFV3TGpjeFV6SXVOU0E0TVM0eU1UWWdNaTQxSURVekxqSXhlaUlnWm1sc2JEMGlJekJtWW1RNFl5SWdjM1J5YjJ0bFBTSWpNR0U0TURWbElpQnpkSEp2YTJVdGQybGtkR2c5SWpVaUx6NDhjR0YwYUNCa1BTSk5NVGt1T1RJZ05UTXVNakZqTUMweE9DNHpPRFlnTVRRdU9UQTBMVE16TGpJNUlETXpMakk1TFRNekxqSTVVemcyTGpVZ016UXVPREkwSURnMkxqVWdOVE11TWpFZ056RXVOVGsySURnMkxqVWdOVE11TWpFZ09EWXVOU0F4T1M0NU1pQTNNUzQxT1RZZ01Ua3VPVElnTlRNdU1qRjZJaUJtYVd4c1BTSWpNR001T1RjeElpQnpkSEp2YTJVOUlpTXdZVGd3TldVaUlITjBjbTlyWlMxM2FXUjBhRDBpTkM0MUlpOCtQSEJoZEdnZ1pEMGlUVFkzTGpNME9DQTBPUzQ0TURKaE5TNHpOaUExTGpNMklEQWdNQ0F4TFRFdU5UZ2dNeTQ0TWpkc0xUZ3VOeklnT0M0M01tRTFMalExSURVdU5EVWdNQ0F3SURFdE55NDJOellnTUd3dE9DNDJPVGd0T0M0M01tRTFMak00SURVdU16Z2dNQ0F3SURFdE1TNDJNREl0TXk0NE1qY2dOUzQxTWlBMUxqVXlJREFnTUNBeElERXVOVGd0TXk0NE5EbGpMalkwTlMwdU5UTTBJREV1TmpBeExURXVOVGdnTVRJdU5UY3RNUzQxT0NBeE1DNDVOamNnTUNBeE1TNDVPU0F4TGpBeU5DQXhNaTQxTkRZZ01TNDFPR0UxTGpReklEVXVORE1nTUNBd0lERWdNUzQxT0NBekxqZzFlaUlnWm1sc2JEMGlibTl1WlNJZ2MzUnliMnRsUFNJak1HRTRNRFZsSWlCemRISnZhMlV0ZDJsa2RHZzlJamN1TlNJdlBqeHdZWFJvSUdROUlrMDJOeTR6TkRnZ05Ea3VPREF5WVRVdU16WWdOUzR6TmlBd0lEQWdNUzB4TGpVNElETXVPREkzYkMwNExqY3lJRGd1TnpKaE5TNDBOU0ExTGpRMUlEQWdNQ0F4TFRjdU5qYzJJREJzTFRndU5qazRMVGd1TnpKaE5TNHpPQ0ExTGpNNElEQWdNQ0F4TFRFdU5qQXlMVE11T0RJM0lEVXVOVElnTlM0MU1pQXdJREFnTVNBeExqVTRMVE11T0RRNVl5NDJORFV0TGpVek5DQXhMall3TVMweExqVTRJREV5TGpVM0xURXVOVGdnTVRBdU9UWTNJREFnTVRFdU9Ua2dNUzR3TWpRZ01USXVOVFEySURFdU5UaGhOUzQwTXlBMUxqUXpJREFnTUNBeElERXVOVGdnTXk0NE5TSWdabWxzYkQwaUkyWm1aaUl2UGp3dmMzWm5QZz09IjsKCiAgY29uc3Qgdm0gPSBTY3JhdGNoLnZtOwogIGNvbnN0IHJ1bnRpbWUgPSB2bS5ydW50aW1lOwogIGNvbnN0IGlzUE0gPSBTY3JhdGNoLmV4dGVuc2lvbnMuaXNQZW5ndWluTW9kOwogIGNvbnN0IFRFTVBfQkxPQ0tfT1BDT0RFID0gIlNQMHpNZW51TWFrZXJfX19TUDB6TWVudU1ha2VyX1RFTVBfQkxPQ0siOyAvLyBvcGNvZGUgb2YgdGhlIHRlbXBvcmFyeSBibG9jayBhZGRlZCB0byBrZWVwIHRoZSBleHRlbnNpb24gaW4gdGhlIHByb2plY3QKCiAgbGV0IGV4dFJldm1vdmFibGUgPSBmYWxzZSwgZXh0ZW5zaW9uSW5zdGFuY2U7IC8vIGNyZWF0ZWQgd2hlbiB0aGUgZXh0ZW5zaW9uIGlzICJyZWdpc3RlcmVkIgogIGxldCBtZW51c1hNTCA9IGA8bGFiZWwgdGV4dD0iVHJ5IGNyZWF0aW5nIHNvbWUgbWVudXMhIiAvPmA7CiAgbGV0IGN1c3RvbU1lbnVzID0gewogICAgIm5ldy1tZW51LTEiOiB7IGl0ZW1zOiBbeyB0ZXh0OiAiZm9vIiwgdmFsdWU6ICJiYXIiIH1dLCBhY2NlcHRSZXBvcnRlcnM6IGZhbHNlIH0KICB9OwoKICAvLyBIZWxwZXIgRnVuY3MKICBjb25zdCBoYXNPd24gPSAob2JqLCBrZXkpID0+IE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIGtleSk7CgogIGNvbnN0IHhtbEVzY2FwZSA9IGZ1bmN0aW9uICh1bnNhZmUpIHsKICAgIHJldHVybiBTY3JhdGNoLkNhc3QudG9TdHJpbmcodW5zYWZlKS5yZXBsYWNlKC9bPD4mJyJdL2csIGMgPT4gewogICAgICBzd2l0Y2ggKGMpIHsKICAgICAgICBjYXNlICI8IjogcmV0dXJuICImbHQ7IjsKICAgICAgICBjYXNlICI+IjogcmV0dXJuICImZ3Q7IjsKICAgICAgICBjYXNlICImIjogcmV0dXJuICImYW1wOyI7CiAgICAgICAgY2FzZSAiJyI6IHJldHVybiAiJmFwb3M7IjsKICAgICAgICBjYXNlICJcIiI6IHJldHVybiAiJnF1b3Q7IjsKICAgICAgfQogICAgfSk7CiAgfTsKCiAgZnVuY3Rpb24gcmVmcmVzaE1hZ2ljKCkgewogICAgbWVudXNYTUwgPSBPYmplY3Qua2V5cyhjdXN0b21NZW51cykubWFwKG1lbnVOYW1lID0+IHsKICAgICAgY29uc3QgbWVudUJsb2NrID0gYFNQMHpNZW51TWFrZXJfbWVudV8ke3htbEVzY2FwZShtZW51TmFtZSl9YDsKICAgICAgcmV0dXJuIGA8YmxvY2sgdHlwZT0iJHttZW51QmxvY2t9IiBpZD0iJHttZW51QmxvY2t9Ij48L2Jsb2NrPmA7CiAgICB9KS5qb2luKCIiKSB8fCBgPGxhYmVsIHRleHQ9IlRyeSBjcmVhdGluZyBzb21lIG1lbnVzISIgLz5gOwogICAgdm0uZXh0ZW5zaW9uTWFuYWdlci5yZWZyZXNoQmxvY2tzKCkudGhlbigoKSA9PiB2bS5yZWZyZXNoV29ya3NwYWNlKCkpOwogIH0KCiAgZnVuY3Rpb24gcGF0Y2hEaXZDb2xvcihjb250YWluZXIsIGlzRGFyaykgewogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb250YWluZXIuY2hpbGROb2Rlcy5sZW5ndGg7IGkrKykgewogICAgICBjb25zdCBjaGlsZCA9IGNvbnRhaW5lci5jaGlsZE5vZGVzW2ldOwogICAgICBjaGlsZC5zdHlsZS5iYWNrZ3JvdW5kID0gaSAlIDIgIT09IDAgPyBgcmFkaWFsLWdyYWRpZW50KGNpcmNsZSwgJHtpc0RhcmsgPyAiIzM0MzQzNCIgOiAiI0Q5RDlEOSJ9IDgwJSwgcmdiYSgwLDAsMCwwKSlgIDogIiI7CiAgICB9CiAgfQoKICBmdW5jdGlvbiBwYXRjaE5hbWUobmFtZSwgYXJyYXkpIHsKICAgIGlmIChhcnJheS5pbmRleE9mKG5hbWUpID4gLTEpIHsKICAgICAgY29uc3QgYXBwZWFyYW5jZSA9IGFycmF5LmZpbHRlcigodikgPT4gdiA9PT0gbmFtZSkubGVuZ3RoOwogICAgICBjb25zdCBsYXN0RGFzaCA9IG5hbWUubGFzdEluZGV4T2YoIi0iKTsKICAgICAgbGV0IG5ld05hbWUgPSBgJHtuYW1lfS0ke2FwcGVhcmFuY2V9YDsKICAgICAgaWYgKGxhc3REYXNoICE9PSAtMSkgewogICAgICAgIGNvbnN0IGxhc3RQYXJ0ID0gbmFtZS5zbGljZShsYXN0RGFzaCArIDEpOwogICAgICAgIGlmICghaXNOYU4ocGFyc2VJbnQobGFzdFBhcnQpKSkgbmV3TmFtZSA9IG5hbWUuc2xpY2UoMCwgbGFzdERhc2gpICsgYC0ke3BhcnNlSW50KGxhc3RQYXJ0KSArIGFwcGVhcmFuY2V9YDsKICAgICAgfQogICAgICByZXR1cm4gYXJyYXkuaW5kZXhPZihuZXdOYW1lKSA+IC0xID8gcGF0Y2hOYW1lKG5ld05hbWUsIGFycmF5KSA6IG5ld05hbWU7CiAgICB9CiAgICByZXR1cm4gbmFtZTsKICB9CgogIC8vIEdVSQogIGZ1bmN0aW9uIG1ha2VUaXRsZSh0eHQpIHsKICAgIGNvbnN0IHRpdGxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7CiAgICB0aXRsZS50ZXh0Q29udGVudCA9IHR4dDsKICAgIHRpdGxlLnNldEF0dHJpYnV0ZSgic3R5bGUiLCAiZGlzcGxheTogaW5saW5lLWJsb2NrOyB0ZXh0LWFsaWduOiBjZW50ZXI7IHdpZHRoOiA0NyU7IG1hcmdpbi1yaWdodDogOHB4OyBtYXJnaW4tbGVmdDogOHB4OyBwYWRkaW5nOiAwcHggMHB4IDIwcHg7Iik7CiAgICByZXR1cm4gdGl0bGU7CiAgfQoKICBmdW5jdGlvbiBtYWtlTGFiZWwodHh0KSB7CiAgICBjb25zdCBsYWJlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpOwogICAgbGFiZWwudGV4dENvbnRlbnQgPSB0eHQ7CiAgICBsYWJlbC5zZXRBdHRyaWJ1dGUoInN0eWxlIiwgIm1hcmdpbjogNXB4OyBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7IHRyYW5zZm9ybTogdHJhbnNsYXRlKDAlLCAtNTUlKTsiKTsKICAgIHJldHVybiBsYWJlbDsKICB9CgogIGZ1bmN0aW9uIGNyZWF0ZUNvbnRhaW4oY2xhc1MsIGRhcmtHVUkpIHsKICAgIGNvbnN0IGJveCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpOwogICAgYm94LmNsYXNzTGlzdC5hZGQoY2xhc1MpOwogICAgYm94LnNldEF0dHJpYnV0ZSgic3R5bGUiLCAib3ZlcmZsb3c6IGhpZGRlbiBzY3JvbGw7IGRpc3BsYXk6IGlubGluZS1ibG9jazsgd2lkdGg6IDQ3JTsgaGVpZ2h0OiAyMDBweDsgcGFkZGluZzogMnB4OyBtYXJnaW4tcmlnaHQ6IDhweDsgbWFyZ2luLWxlZnQ6IDhweDsgYm9yZGVyLXJhZGl1czogNXB4OyIpOwogICAgYm94LnN0eWxlLmJvcmRlciA9IGBzb2xpZCAke2RhcmtHVUkgPyAiIzM0MzQzNCIgOiAiI0Q5RDlEOSJ9IDJweGA7CiAgICByZXR1cm4gYm94OwogIH0KCiAgZnVuY3Rpb24gbWFrZUJ1dHRvbihpbWcsIGNsYXNTKSB7CiAgICBjb25zdCBidXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJpbWciKTsKICAgIGJ1dHRvbi5jbGFzc0xpc3QuYWRkKGNsYXNTKTsKICAgIGJ1dHRvbi5zcmMgPSBpbWc7CiAgICBidXR0b24ud2lkdGggPSAiMzIiOwogICAgYnV0dG9uLnN0eWxlLmN1cnNvciA9ICJwb2ludGVyIjsKICAgIHJldHVybiBidXR0b247CiAgfQoKICBmdW5jdGlvbiBtYWtlSW5wdXQodHlwZSwgZGVmYXVsdFYsIG9wdHMpIHsKICAgIGNvbnN0IGlucHV0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiaW5wdXQiKTsKICAgIGlucHV0LnR5cGUgPSB0eXBlOwogICAgaW5wdXQudmFsdWUgPSBkZWZhdWx0VjsKICAgIGlucHV0LnN0eWxlLndpZHRoID0gb3B0cz8ud2lkdGggPz8gIjEzMHB4IjsKICAgIGlucHV0LnN0eWxlLnRyYW5zZm9ybSA9ICJ0cmFuc2xhdGUoMCUsIC00NSUpIjsKICAgIGlucHV0LnN0eWxlLmN1cnNvciA9ICJwb2ludGVyIjsKICAgIHJldHVybiBpbnB1dDsKICB9CgogIGZ1bmN0aW9uIGdob3N0SW5wdXRSZW1vdmUoc2VsZWN0b3IpIHsKICAgIC8vIEJsb2NrIFRleHQgaW5wdXQgRG9lc250IHNob3cgaW1tZWRpYXRlbHkgOigKICAgIGNvbnN0IGVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHNlbGVjdG9yKTsKICAgIGlmIChlbGVtZW50KSBlbGVtZW50LnN0eWxlLm9wYWNpdHkgPSAwOwogICAgZWxzZSBzZXRUaW1lb3V0KCgpID0+IHsgZ2hvc3RJbnB1dFJlbW92ZShzZWxlY3RvcikgfSwgNSk7CiAgfQoKICBmdW5jdGlvbiBtYWtlTWVudU5hbWVSb3cobmFtZSwgbmFtZXNBcnJheSwgaXNEYXJrLCBjb250YWluKSB7CiAgICBjb25zdCByb3dEaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTsKICAgIHJvd0Rpdi5zdHlsZS5oZWlnaHQgPSAiMTclIjsKICAgIGlmIChuYW1lc0FycmF5LmluZGV4T2YobmFtZSkgJSAyICE9PSAwKSByb3dEaXYuc3R5bGUuYmFja2dyb3VuZCA9IGByYWRpYWwtZ3JhZGllbnQoY2lyY2xlLCAke2lzRGFyayA/ICIjMzQzNDM0IiA6ICIjRDlEOUQ5In0gODAlLCByZ2JhKDAsMCwwLDApKWA7CgogICAgLy8gRGVsZXRlIEJ1dHRvbgogICAgY29uc3QgZGVsID0gbWFrZUJ1dHRvbihkZWxldGVTVkcsICJkZWxldGUiKTsKICAgIHJvd0Rpdi5hcHBlbmRDaGlsZChkZWwpOwogICAgZGVsLmFkZEV2ZW50TGlzdGVuZXIoImNsaWNrIiwgKCkgPT4gewogICAgICAvLyBTdXBlciBzZWNyZXQgY29tbWVudCBmcm9tIGFzaGltZSA8MwogICAgICBkZWxldGUgY3VzdG9tTWVudXNbbmFtZV07CiAgICAgIG5hbWVzQXJyYXkuc3BsaWNlKG5hbWVzQXJyYXkuaW5kZXhPZihuYW1lKSwgMSk7CiAgICAgIHJvd0Rpdi5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHJvd0Rpdik7CiAgICAgIHBhdGNoRGl2Q29sb3IoY29udGFpbiwgaXNEYXJrKTsKCiAgICAgIC8vIFJlbW92ZSBJdGVtcyBDb250YWluZXIKICAgICAgY29uc3QgaXRlbUNvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYFtjbGFzcz0iaXRlbXMiXWApOwogICAgICBpdGVtQ29uLmlubmVySFRNTCA9ICIiOwogICAgfSk7CgogICAgLy8gRWRpdCBCdXR0b24KICAgIGNvbnN0IGVkaXQgPSBtYWtlQnV0dG9uKGVkaXRTVkcsICJlZGl0Iik7CiAgICByb3dEaXYuYXBwZW5kQ2hpbGQoZWRpdCk7CiAgICBlZGl0LmFkZEV2ZW50TGlzdGVuZXIoImNsaWNrIiwgKCkgPT4gewogICAgICBwYXRjaERpdkNvbG9yKGNvbnRhaW4sIGlzRGFyayk7CiAgICAgIHJvd0Rpdi5zdHlsZS5iYWNrZ3JvdW5kID0gYHJhZGlhbC1ncmFkaWVudChjaXJjbGUsICNhM2EzYTMgODAlLCByZ2JhKDAsMCwwLDApKWA7CiAgICAgIHJlbmRlckl0ZW1MaXN0KGN1c3RvbU1lbnVzW25hbWVdLCBpc0RhcmssIG5hbWUpOwogICAgfSk7CgogICAgLy8gVGV4dCAmIElucHV0CiAgICBjb25zdCBsaXN0SXRlbSA9IG1ha2VJbnB1dCgidGV4dCIsIG5hbWUpOwogICAgbGlzdEl0ZW0uYWRkRXZlbnRMaXN0ZW5lcigiY2hhbmdlIiwgKCkgPT4gewogICAgICBjb25zdCBvbGRWYWx1ZSA9IGN1c3RvbU1lbnVzW25hbWVdOwogICAgICBkZWxldGUgY3VzdG9tTWVudXNbbmFtZV07CiAgICAgIGNvbnN0IG5ld05hbWUgPSBwYXRjaE5hbWUobGlzdEl0ZW0udmFsdWUsIG5hbWVzQXJyYXkpOwogICAgICBjdXN0b21NZW51c1tuZXdOYW1lXSA9IG9sZFZhbHVlOwogICAgICBuYW1lc0FycmF5W25hbWVzQXJyYXkuaW5kZXhPZihuYW1lKV0gPSBuZXdOYW1lOwoKICAgICAgLy8gcmVmcmVzaCBtb2RhbCAod2lsbCBidWcgb3V0IGlmIG5vdCByZWZyZXNoZWQpCiAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgIGNvbnN0IHBhcmVudCA9IHJvd0Rpdi5wYXJlbnROb2RlLnBhcmVudE5vZGU7CiAgICAgICAgZm9yIChsZXQgaSA9IHBhcmVudC5jaGlsZE5vZGVzLmxlbmd0aCAtIDE7IGktLTsgKSBwYXJlbnQuY2hpbGROb2Rlc1tpXS5yZW1vdmUoKTsKICAgICAgICBjcmVhdGVNZW51TGlzdChPYmplY3Qua2V5cyhjdXN0b21NZW51cyksIHBhcmVudCwgaXNEYXJrKTsKICAgICAgfSwgNSk7CiAgICB9KTsKICAgIGxpc3RJdGVtLmFkZEV2ZW50TGlzdGVuZXIoImNsaWNrIiwgKCkgPT4gewogICAgICBwYXRjaERpdkNvbG9yKGNvbnRhaW4sIGlzRGFyayk7CiAgICAgIHJvd0Rpdi5zdHlsZS5iYWNrZ3JvdW5kID0gYHJhZGlhbC1ncmFkaWVudChjaXJjbGUsICNhM2EzYTMgODAlLCByZ2JhKDAsMCwwLDApKWA7CiAgICAgIHJlbmRlckl0ZW1MaXN0KGN1c3RvbU1lbnVzW25hbWVdLCBpc0RhcmssIG5hbWUpOwogICAgfSk7CiAgICByb3dEaXYuYXBwZW5kKG1ha2VMYWJlbCgiTmFtZToiKSwgbGlzdEl0ZW0pOwogICAgcmV0dXJuIHJvd0RpdjsKICB9CgogIGZ1bmN0aW9uIG1ha2VJdGVtUm93KGl0ZW0sIGluZGV4LCBpc0RhcmssIGNvbnRhaW4sIG5hbWUpIHsKICAgIGNvbnN0IHJvd0RpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpOwogICAgcm93RGl2LnN0eWxlLmhlaWdodCA9ICIxNyUiOwogICAgaWYgKGluZGV4ICUgMiAhPT0gMCkgcm93RGl2LnN0eWxlLmJhY2tncm91bmQgPSBgcmFkaWFsLWdyYWRpZW50KGNpcmNsZSwgJHtpc0RhcmsgPyAiIzM0MzQzNCIgOiAiI0Q5RDlEOSJ9IDgwJSwgcmdiYSgwLDAsMCwwKSlgOwoKICAgIC8vIERlbGV0ZSBCdXR0b24KICAgIGNvbnN0IGRlbCA9IG1ha2VCdXR0b24oZGVsZXRlU1ZHLCAiZGVsZXRlIik7CiAgICByb3dEaXYuYXBwZW5kQ2hpbGQoZGVsKTsKICAgIGRlbC5hZGRFdmVudExpc3RlbmVyKCJjbGljayIsICgpID0+IHsKICAgICAgY3VzdG9tTWVudXNbbmFtZV0uaXRlbXMuc3BsaWNlKGluZGV4LCAxKTsKICAgICAgcmVuZGVySXRlbUxpc3QoY3VzdG9tTWVudXNbbmFtZV0sIGlzRGFyaywgbmFtZSk7CiAgICB9KTsKCiAgICAvLyBUZXh0ICYgSW5wdXQKICAgIGNvbnN0IHRleHQgPSBtYWtlSW5wdXQoInRleHQiLCBpdGVtLnRleHQsIHsgd2lkdGg6ICI2NXB4IiB9KTsKICAgIHRleHQuYWRkRXZlbnRMaXN0ZW5lcigiY2hhbmdlIiwgKCkgPT4geyBjdXN0b21NZW51c1tuYW1lXS5pdGVtc1tpbmRleF0udGV4dCA9IHRleHQudmFsdWUgfSk7CiAgICBjb25zdCB2YWx1ZSA9IG1ha2VJbnB1dCgidGV4dCIsIGl0ZW0udmFsdWUsIHsgd2lkdGg6ICI2NXB4IiB9KTsKICAgIHZhbHVlLmFkZEV2ZW50TGlzdGVuZXIoImNoYW5nZSIsICgpID0+IHsgY3VzdG9tTWVudXNbbmFtZV0uaXRlbXNbaW5kZXhdLnZhbHVlID0gdmFsdWUudmFsdWUgfSk7CiAgICByb3dEaXYuYXBwZW5kKG1ha2VMYWJlbCgiVGV4dDoiKSwgdGV4dCwgbWFrZUxhYmVsKCJWYWx1ZToiKSwgdmFsdWUpOwogICAgcmV0dXJuIHJvd0RpdjsKICB9CgogIC8vIEludGVybmFsIEdVSQogIGZ1bmN0aW9uIGNyZWF0ZU1lbnVMaXN0KG5hbWVzQXJyYXksIHBhcmVudCwgaXNEYXJrKSB7CiAgICAvLyBJbm5lciBUaXRsZXMgYW5kIENvbnRhaW5lcnMKICAgIGNvbnN0IHRpdGxlMSA9IG1ha2VUaXRsZSgiQ3JlYXRlZCBEcm9wZG93bnMiKSwgdGl0bGUyID0gbWFrZVRpdGxlKCJJdGVtcyBpbiBEcm9wZG93biIpOwogICAgY29uc3QgbGlzdENvbiA9IGNyZWF0ZUNvbnRhaW4oIm1lbnVzIiwgaXNEYXJrKTsKICAgIG5hbWVzQXJyYXkuZm9yRWFjaCgobmFtZSkgPT4gewogICAgICBsaXN0Q29uLmFwcGVuZENoaWxkKG1ha2VNZW51TmFtZVJvdyhuYW1lLCBuYW1lc0FycmF5LCBpc0RhcmssIGxpc3RDb24pKTsKICAgIH0pOwoKICAgIC8vIEFkZCBCdXR0b24KICAgIGNvbnN0IGFkZCA9IG1ha2VCdXR0b24oYWRkU1ZHLCAiYWRkIik7CiAgICBhZGQuYWRkRXZlbnRMaXN0ZW5lcigiY2xpY2siLCAoKSA9PiB7CiAgICAgIGNvbnN0IG5ld04gPSBwYXRjaE5hbWUoYG5ldy1tZW51LSR7bmFtZXNBcnJheS5sZW5ndGggKyAxfWAsIG5hbWVzQXJyYXkpOwogICAgICBjdXN0b21NZW51c1tuZXdOXSA9IHsgaXRlbXM6IFt7IHRleHQ6ICJmb28iLCB2YWx1ZTogImJhciIgfV0sIGFjY2VwdFJlcG9ydGVyczogZmFsc2UgfTsKICAgICAgbmFtZXNBcnJheS5wdXNoKG5ld04pOwogICAgICBsaXN0Q29uLmluc2VydEJlZm9yZShtYWtlTWVudU5hbWVSb3cobmV3TiwgbmFtZXNBcnJheSwgaXNEYXJrLCBsaXN0Q29uKSwgYWRkKTsKICAgICAgcGF0Y2hEaXZDb2xvcihsaXN0Q29uLCBpc0RhcmspOwogICAgfSk7CiAgICBsaXN0Q29uLmFwcGVuZENoaWxkKGFkZCk7CgogICAgLy8gTWVudSBJdGVtcyBDb250YWluZXIgKEluaXRpYWxseSBCbGFuaykKICAgIHBhcmVudC5pbnNlcnRCZWZvcmUoY3JlYXRlQ29udGFpbigiaXRlbXMiLCBpc0RhcmspLCBwYXJlbnQuY2hpbGRyZW5bMF0pOwogICAgcGFyZW50Lmluc2VydEJlZm9yZShsaXN0Q29uLCBwYXJlbnQuY2hpbGRyZW5bMF0pOwogICAgcGFyZW50Lmluc2VydEJlZm9yZSh0aXRsZTIsIHBhcmVudC5jaGlsZHJlblswXSk7CiAgICBwYXJlbnQuaW5zZXJ0QmVmb3JlKHRpdGxlMSwgcGFyZW50LmNoaWxkcmVuWzBdKTsKICB9CgogIGZ1bmN0aW9uIHJlbmRlckl0ZW1MaXN0KGl0ZW1zLCBpc0RhcmssIGtleSkgewogICAgY29uc3QgaXRlbUNvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYFtjbGFzcz0iaXRlbXMiXWApOwogICAgaXRlbUNvbi5pbm5lckhUTUwgPSAiIjsgLy8gY2xlYW5zZSBpdGVtcwogICAgaXRlbXMgPSBpdGVtcy5pdGVtczsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgaXRlbXMubGVuZ3RoOyBpKyspIGl0ZW1Db24uYXBwZW5kQ2hpbGQobWFrZUl0ZW1Sb3coaXRlbXNbaV0sIGksIGlzRGFyaywgaXRlbUNvbiwga2V5KSk7CgogICAgLy8gQWRkIEJ1dHRvbgogICAgY29uc3QgYWRkID0gbWFrZUJ1dHRvbihhZGRTVkcsICJhZGRJdGVtIik7CiAgICBhZGQuYWRkRXZlbnRMaXN0ZW5lcigiY2xpY2siLCAoKSA9PiB7CiAgICAgIGN1c3RvbU1lbnVzW2tleV0uaXRlbXMucHVzaCh7IHRleHQ6ICJuZXcgaXRlbSIsIHZhbHVlOiAibmV3IHZhbHVlIiB9KTsKICAgICAgcmVuZGVySXRlbUxpc3QoY3VzdG9tTWVudXNba2V5XSwgaXNEYXJrLCBrZXkpOwogICAgfSk7CiAgICBpdGVtQ29uLmFwcGVuZENoaWxkKGFkZCk7CiAgfQoKICBmdW5jdGlvbiBpbml0TWVudU1ha2VyKCkgewogICAgZXh0UmV2bW92YWJsZSA9IGZhbHNlOwogICAgY29uc3QgYWxsQmxvY2tzID0gU2NyYXRjaEJsb2Nrcy5tYWluV29ya3NwYWNlLmJsb2NrREJfOyAvLyBDdXN0b20gQmxvY2sgTW9kYWwgT3ZlcnJpZGVzIEJsb2NrREIKICAgIFNjcmF0Y2hCbG9ja3MuUHJvY2VkdXJlcy5jcmVhdGVQcm9jZWR1cmVEZWZDYWxsYmFja18oKTsKICAgIGNvbnN0IGlzRGFyayA9IGlzUE0gPyBkb2N1bWVudC5ib2R5LmdldEF0dHJpYnV0ZSgidGhlbWUiKSA9PT0gImRhcmsiIDogUmVkdXhTdG9yZS5nZXRTdGF0ZSgpLnNjcmF0Y2hHdWkudGhlbWUudGhlbWUuZ3VpID09PSAiZGFyayI7CgogICAgLy8gQ2xlYW4gTW9kYWwKICAgIGNvbnN0IGJsb2NrU3BhY2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGBbY2xhc3NePSJjdXN0b20tcHJvY2VkdXJlc193b3Jrc3BhY2VfIl1gKTsKICAgIGJsb2NrU3BhY2UucmVtb3ZlKCk7CiAgICBjb25zdCBidXR0b25zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgW2NsYXNzKj0iY3VzdG9tLXByb2NlZHVyZXNfYm9keV8iXWApOwogICAgZm9yIChsZXQgaSA9IGJ1dHRvbnMuY2hpbGRyZW4ubGVuZ3RoIC0gMTsgaS0tOykgYnV0dG9ucy5yZW1vdmVDaGlsZChidXR0b25zLmZpcnN0Q2hpbGQpOwoKICAgIC8vIE5ldyBUaXRsZQogICAgY29uc3QgdGl0bGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGBbY2xhc3MqPSJtb2RhbF9oZWFkZXItaXRlbS10aXRsZV8iXWApOwogICAgdGl0bGUudGV4dENvbnRlbnQgPSAiTWFrZSBhIERyb3Bkb3duIjsKCiAgICBjcmVhdGVNZW51TGlzdChPYmplY3Qua2V5cyhjdXN0b21NZW51cyksIGJ1dHRvbnMsIGlzRGFyayk7CiAgICBnaG9zdElucHV0UmVtb3ZlKGBbY2xhc3MqPSJyZW1vdmFibGVUZXh0SW5wdXQiXWApOwoKICAgIC8vIE92ZXJyaWRlICJPSyIgQnV0dG9uCiAgICBjb25zdCBva0J0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYFtjbGFzc149ImN1c3RvbS1wcm9jZWR1cmVzX29rLWJ1dHRvbl8iXWApOwogICAgY29uc3QgY2xvbmVkT2tCdG4gPSBva0J0bi5jbG9uZU5vZGUodHJ1ZSk7CiAgICBva0J0bi5yZXBsYWNlV2l0aChjbG9uZWRPa0J0bik7CiAgICBjbG9uZWRPa0J0bi5hZGRFdmVudExpc3RlbmVyKCJjbGljayIsICgpID0+IHsKICAgICAgLy8gQWxsIE1lbnVzIHNob3VsZCBIYXZlIEF0IGxlYXN0IDEgaW4gYSBNZW51CiAJCQlmb3IgKGNvbnN0IFtrZXksIG1lbnVdIG9mIE9iamVjdC5lbnRyaWVzKGN1c3RvbU1lbnVzKSkgewogIAkJCWlmIChtZW51Lml0ZW1zLmxlbmd0aCA9PT0gMCkgbWVudS5pdGVtcyA9IFt7IHRleHQ6ICJmb28iLCB2YWx1ZTogImJhciIgfV07CgkJCX0KICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgW2NsYXNzXj0iY2xvc2UtYnV0dG9uX2Nsb3NlLWJ1dHRvbl8iXWApLmNsaWNrKCk7CiAgICAgIHJlZnJlc2hNYWdpYygpOwoKICAgICAgLy8gUmVtb3ZlIE1lbnUgQmxvY2tzIHRoYXQgbm8gTG9uZ2VyIEV4aXN0CiAgICAgIGNvbnN0IG1lbnVOYW1lcyA9IE9iamVjdC5rZXlzKGN1c3RvbU1lbnVzKTsKICAgICAgZm9yIChjb25zdCBba2V5LCBibG9ja10gb2YgT2JqZWN0LmVudHJpZXMoYWxsQmxvY2tzKSkgewogICAgICAgIGlmIChibG9jay50eXBlLnN0YXJ0c1dpdGgoIlNQMHpNZW51TWFrZXJfbWVudV8iKSkgewogICAgICAgICAgaWYgKG1lbnVOYW1lcy5pbmRleE9mKGJsb2NrLnR5cGUucmVwbGFjZSgiU1Awek1lbnVNYWtlcl9tZW51XyIsICIiKSkgPT09IC0xKSBibG9jay5kaXNwb3NlKCk7CiAgICAgICAgfQoJCSAgfQogICAgfSk7CiAgfQoKICAvLyBNZW51IEJsb2NrIENvbG9yIFNldHRlcnMKICBmdW5jdGlvbiB1cGRhdGVNZW51Q29sb3IoaWQsIG1haW5Xb3Jrc3BhY2UsIHRyZWUpIHsKICAgIGNvbnN0IGJsb2NrID0gbWFpbldvcmtzcGFjZS5nZXRCbG9ja0J5SWQoaWQpOwogICAgaWYgKCFibG9jayB8fCAhYmxvY2sudHlwZS5zdGFydHNXaXRoKCJTUDB6TWVudU1ha2VyX21lbnUiKSkgewogICAgICBpZiAoYmxvY2sgJiYgdHJlZSAmJiBibG9jay5jaGlsZEJsb2Nrc18pIHsKICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGJsb2NrLmNoaWxkQmxvY2tzXy5sZW5ndGg7IGkrKykgewogICAgICAgICAgY29uc3QgY2hpbGQgPSBibG9jay5jaGlsZEJsb2Nrc19baV07CiAgICAgICAgICBpZiAoY2hpbGQudHlwZS5zdGFydHNXaXRoKCJTUDB6TWVudU1ha2VyX21lbnUiKSkgdXBkYXRlTWVudUNvbG9yKGNoaWxkLmlkLCBtYWluV29ya3NwYWNlLCBmYWxzZSk7CiAgICAgICAgICBlbHNlIGlmIChjaGlsZC5jaGlsZEJsb2Nrc18pIHVwZGF0ZU1lbnVDb2xvcihjaGlsZC5pZCwgbWFpbldvcmtzcGFjZSwgdHJ1ZSk7CiAgICAgICAgfQogICAgICB9CiAgICAgIHJldHVybjsKICAgIH0KICAgIGNvbnN0IHBhcmVudCA9IGJsb2NrLnBhcmVudEJsb2NrXzsKICAgIGNvbnN0IGJveCA9IGJsb2NrLmlucHV0TGlzdFswXT8uZmllbGRSb3dbMF0/LmJveF87CiAgICBpZiAoIWJveCkgcmV0dXJuOwogICAgaWYgKHBhcmVudCkgewogICAgICBibG9jay5zZXRDb2xvdXIocGFyZW50LmNvbG91cl8sIHBhcmVudC5jb2xvdXJTZWNvbmRhcnlfLCBwYXJlbnQuY29sb3VyVGVydGlhcnlfKTsKICAgICAgYm94LnNldEF0dHJpYnV0ZSgiZmlsbCIsIHBhcmVudC5jb2xvdXJfKTsKICAgICAgYm94LnNldEF0dHJpYnV0ZSgic3Ryb2tlIiwgcGFyZW50LmNvbG91clRlcnRpYXJ5Xyk7CiAgICB9IGVsc2UgewogICAgICBibG9jay5zZXRDb2xvdXIoIiMwRkJEOEMiLCAiIzBlYWE3ZSIsICIjMGM5NzcwIik7CiAgICAgIGJveC5zZXRBdHRyaWJ1dGUoImZpbGwiLCAiIzBGQkQ4QyIpOwogICAgICBib3guc2V0QXR0cmlidXRlKCJzdHJva2UiLCAiIzBjOTc3MCIpOwogICAgfQogIH0KCiAgZnVuY3Rpb24gYXR0YWNoRXZlbnRzKCkgewogICAgaWYgKFNjcmF0Y2guZ3VpKSBTY3JhdGNoLmd1aS5nZXRCbG9ja2x5KCkudGhlbihTQiA9PiB7CiAgICAgIGNvbnN0IG1haW5Xb3Jrc3BhY2UgPSBTQi5tYWluV29ya3NwYWNlOwogICAgICBjb25zdCB3b3Jrc3BhY2VFdmVudHMgPSAoZSkgPT4gewogICAgICAgIGlmIChlLnR5cGUgPT0gU0IuRXZlbnRzLkVORF9EUkFHICYmIE9iamVjdC5oYXNPd24oZSwgImJsb2NrSWQiKSkgewogICAgICAgICAgaWYgKG1haW5Xb3Jrc3BhY2UuaWQgPT09IGUud29ya3NwYWNlSWQpIHVwZGF0ZU1lbnVDb2xvcihlLmJsb2NrSWQsIG1haW5Xb3Jrc3BhY2UsIHRydWUpOwogICAgICAgIH0KICAgICAgfQogICAgICBtYWluV29ya3NwYWNlLmFkZENoYW5nZUxpc3RlbmVyKHdvcmtzcGFjZUV2ZW50cyk7CiAgICAgIGNvbnN0IHVwZGF0ZUFsbEJsb2NrcyA9ICgpID0+IHsKICAgICAgICBmb3IgKGNvbnN0IFtrZXksIGJsb2NrXSBvZiBPYmplY3QuZW50cmllcyhtYWluV29ya3NwYWNlLmJsb2NrREJfKSkgdXBkYXRlTWVudUNvbG9yKGJsb2NrLmlkLCBtYWluV29ya3NwYWNlLCBmYWxzZSk7CiAgICAgIH07CiAgICAgIHZtLm9uKCJ3b3Jrc3BhY2VVcGRhdGUiLCB1cGRhdGVBbGxCbG9ja3MpOwogICAgICB1cGRhdGVBbGxCbG9ja3MoKTsKCSAgfSk7CiAgfQogIGZ1bmN0aW9uIHN0YXJ0TGlzdGVuZXJXb3JrZXIoKSB7CiAgICBpZiAodHlwZW9mIFJlZHV4U3RvcmUgPT09ICJ1bmRlZmluZWQiKSByZXR1cm47CiAgICBjb25zdCBjaGVja0luRWRpdG9yID0gKCkgPT4gIVJlZHV4U3RvcmUuZ2V0U3RhdGUoKS5zY3JhdGNoR3VpLm1vZGUuaXNQbGF5ZXJPbmx5OwogICAgbGV0IGluRWRpdG9yID0gY2hlY2tJbkVkaXRvcigpOwogICAgaWYgKGluRWRpdG9yKSBhdHRhY2hFdmVudHMoKTsKICAgIFJlZHV4U3RvcmUuc3Vic2NyaWJlKCgpID0+IHsKICAgICAgY29uc3QgY3VycmVudGx5SW5FZGl0b3IgPSBjaGVja0luRWRpdG9yKCk7CiAgICAgIGlmIChpbkVkaXRvciAhPT0gY3VycmVudGx5SW5FZGl0b3IpIHsKICAgICAgICBpbkVkaXRvciA9IGN1cnJlbnRseUluRWRpdG9yOwogICAgICAgIGlmIChpbkVkaXRvcikgYXR0YWNoRXZlbnRzKCk7CiAgICAgIH0KICAgIH0pOwogIH0KICBpZiAodHlwZW9mIHNjYWZmb2xkaW5nID09PSAidW5kZWZpbmVkIikgc3RhcnRMaXN0ZW5lcldvcmtlcigpOwoKICBjbGFzcyBTUDB6TWVudU1ha2VyIHsKICAgIGNvbnN0cnVjdG9yKCkgewogICAgICBjb25zdCBzZWxmID0gdGhpczsgLy8gVG8gYXZvaWQgc2xvdyB3cml0ZXMgZXZlcnkgdGltZSBhIG1lbnUgaXMgY2hhbmdlZAogICAgICBjb25zdCBvbGRUb0pTT04gPSB2bS5jb25zdHJ1Y3Rvci5wcm90b3R5cGUudG9KU09OOwogICAgICB2bS5jb25zdHJ1Y3Rvci5wcm90b3R5cGUudG9KU09OID0gZnVuY3Rpb24gKC4uLmFyZ3MpIHsKICAgICAgICBpZiAoZXh0UmV2bW92YWJsZSkgcmV0dXJuIG9sZFRvSlNPTi5hcHBseSh0aGlzLCBhcmdzKTsKICAgICAgICBpZiAoIWlzUE0pIHZtLnJ1bnRpbWUuZXh0ZW5zaW9uU3RvcmFnZS5TUDB6TWVudU1ha2VyID0gc2VsZi5zZXJpYWxpemUoKS5TUDB6TWVudU1ha2VyOwoKICAgICAgICAvLyBNYWtlIHRoZSBleHRlbnNpb24gc3RheSBieSBhZGRpbmcgYSBkdW1teSBibG9jawogICAgICAgIGNvbnN0IGJsb2NrcyA9IHJ1bnRpbWUudGFyZ2V0c1swXS5ibG9ja3M7CiAgICAgICAgYmxvY2tzLl9ibG9ja3NbVEVNUF9CTE9DS19PUENPREVdID0gewogICAgICAgICAgb3Bjb2RlOiBURU1QX0JMT0NLX09QQ09ERSwgaWQ6IFRFTVBfQkxPQ0tfT1BDT0RFLCBmaWVsZHM6IHt9LAogICAgICAgICAgbmV4dDogbnVsbCwgcGFyZW50OiBudWxsLCBzaGFkb3c6IGZhbHNlLCB0b0xldmVsOiB0cnVlLAogICAgICAgICAgeDogdW5kZWZpbmVkLCB5OiB1bmRlZmluZWQKICAgICAgICB9CiAgICAgICAgY29uc3QganNvblN0ciA9IG9sZFRvSlNPTi5hcHBseSh0aGlzLCBhcmdzKTsKICAgICAgICAvLyBCbG9jayBJRHMgbWF5IGhhdmUgYmVlbiBjb21wcmVzc2VkIGF0IHRoaXMgcG9pbnQKICAgICAgICBjb25zdCB0ZW1wQmxvY2tJZCA9IE9iamVjdC52YWx1ZXMoYmxvY2tzLl9ibG9ja3MpLmZpbmQobyA9PiBvLm9wY29kZSA9PT0gVEVNUF9CTE9DS19PUENPREUpPy5pZDsKICAgICAgICBpZiAodGVtcEJsb2NrSWQpIGRlbGV0ZSBibG9ja3MuX2Jsb2Nrc1t0ZW1wQmxvY2tJZF07CiAgICAgICAgcmV0dXJuIGpzb25TdHI7CiAgICAgIH07CgogICAgICBjb25zdCBvbGRpbnN0YWxsVGFyZ2V0cyA9IHZtLmluc3RhbGxUYXJnZXRzOwogICAgICB2bS5pbnN0YWxsVGFyZ2V0cyA9IGZ1bmN0aW9uICguLi5hcmdzKSB7CiAgICAgICAgLy8gUmVtb3ZlIHRoZSBkdW1teSBibG9jawogICAgICAgIGlmIChhcmdzWzBdICYmIGFyZ3NbMF1bMF0pIHsKICAgICAgICAgIGNvbnN0IHRlbXBCbG9ja0lkID0gT2JqZWN0LnZhbHVlcyhhcmdzWzBdWzBdLmJsb2Nrcy5fYmxvY2tzKS5maW5kKG8gPT4gby5vcGNvZGUgPT09IFRFTVBfQkxPQ0tfT1BDT0RFKT8uaWQ7CiAgICAgICAgICBpZiAodGVtcEJsb2NrSWQpIGRlbGV0ZSBhcmdzWzBdWzBdLmJsb2Nrcy5fYmxvY2tzW3RlbXBCbG9ja0lkXTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIG9sZGluc3RhbGxUYXJnZXRzLmFwcGx5KHRoaXMsIGFyZ3MpOwogICAgICB9OwoKICAgICAgLy8gTG9hZCB0aGUgbWVudXMKICAgICAgdGhpcy5yZWZyZXNoU3RvcmFnZSgpOwogICAgICB2bS5ydW50aW1lLm9uKCJQUk9KRUNUX0xPQURFRCIsICgpID0+IHsKICAgICAgICBjb25zdCByZWZyZXNoV29ya3NwYWNlID0gdm0ucmVmcmVzaFdvcmtzcGFjZTsKICAgICAgICB2bS5yZWZyZXNoV29ya3NwYWNlID0gKCkgPT4ge307CiAgICAgICAgdGhpcy5yZWZyZXNoU3RvcmFnZSgpOwogICAgICAgIHZtLmV4dGVuc2lvbk1hbmFnZXIucmVmcmVzaEJsb2NrcygpOwogICAgICAgIHZtLnJlZnJlc2hXb3Jrc3BhY2UgPSByZWZyZXNoV29ya3NwYWNlOwogICAgICAgIHZtLm9uY2UoIkJFRk9SRV9FWEVDVVRFIiwgKCkgPT4gdm0ucmVmcmVzaFdvcmtzcGFjZSgpKTsKICAgIAl9KTsKICAgIH0KCiAgICByZWZyZXNoU3RvcmFnZSgpIHsgLy8gVHVyYm9XYXJwIHN1cHBvcnQKICAgICAgaWYgKCFpc1BNKSB0aGlzLmRlc2VyaWFsaXplKHZtLnJ1bnRpbWUuZXh0ZW5zaW9uU3RvcmFnZSk7CiAgICB9CiAgICBnZXRJbmZvKCkgewogICAgICAvLyBVc2VkIHRvIExvYWQgdGhlIE1lbnVzCiAgICAgIGlmICh0aGlzLm5lZWRzUmVmcmVzaCkgewogICAgICAgIHRoaXMubmVlZHNSZWZyZXNoID0gZmFsc2U7CiAgICAgICAgc2V0VGltZW91dCgoKSA9PiByZWZyZXNoTWFnaWMoKSwgMCk7CiAgICAgIH0KICAgICAgcmV0dXJuIHsKICAgICAgICBpZDogIlNQMHpNZW51TWFrZXIiLAogICAgICAgIG5hbWU6ICJEcm9wZG93biBNYWtlciIsCiAgICAgICAgbWVudUljb25VUkksCiAgICAgICAgYmxvY2tzOiBbCiAgICAgICAgICB7CiAgICAgICAgICAgIGZ1bmM6ICJtYWtlTWVudSIsCiAgICAgICAgICAgIGJsb2NrVHlwZTogU2NyYXRjaC5CbG9ja1R5cGUuQlVUVE9OLAogICAgICAgICAgICB0ZXh0OiAiT3BlbiBNZW51IEVkaXRvciIKICAgICAgICAgIH0sCiAgICAgICAgICB7CiAgICAgICAgICAgIGZ1bmM6ICJyZW1vdmVFeHQiLAogICAgICAgICAgICBibG9ja1R5cGU6IFNjcmF0Y2guQmxvY2tUeXBlLkJVVFRPTiwKICAgICAgICAgICAgdGV4dDogIlJlbW92ZSB0aGlzIEV4dGVuc2lvbiIKICAgICAgICAgIH0sCiAgICAgICAgICB7CiAgICAgICAgICAgIG9wY29kZTogImltcG9ydE1lbnVzIiwKICAgICAgICAgICAgYmxvY2tUeXBlOiBTY3JhdGNoLkJsb2NrVHlwZS5DT01NQU5ELAogICAgICAgICAgICB0ZXh0OiAiaW1wb3J0IGN1c3RvbSBkcm9wZG93biBKU09OIFtNRU5VU10iLAogICAgICAgICAgICBhcmd1bWVudHM6IHsKICAgICAgICAgICAgICBNRU5VUzogeyB0eXBlOiBTY3JhdGNoLkFyZ3VtZW50VHlwZS5TVFJJTkcsIGRlZmF1bHRWYWx1ZTogYHsgIm15TWVudS0xIjogeyAiaXRlbXMiOiBbeyAidGV4dCI6ICJvbmUiLCAidmFsdWUiOiAiMSIgfV0gfSB9YCB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0sCiAgICAgICAgICB7CiAgICAgICAgICAgIG9wY29kZTogImV4cG9ydE1lbnVzIiwKICAgICAgICAgICAgYmxvY2tUeXBlOiBTY3JhdGNoLkJsb2NrVHlwZS5SRVBPUlRFUiwKICAgICAgICAgICAgdGV4dDogImN1c3RvbSBkcm9wZG93bnMgSlNPTiIKICAgICAgICAgIH0sCiAgICAgICAgICB7IGJsb2NrVHlwZTogU2NyYXRjaC5CbG9ja1R5cGUuTEFCRUwsIHRleHQ6ICJNeSBNZW51cyIgfSwKICAgICAgICAgIHsgYmxvY2tUeXBlOiBTY3JhdGNoLkJsb2NrVHlwZS5YTUwsIHhtbDogbWVudXNYTUwgfQogICAgICAgIF0sCiAgICAgICAgbWVudXM6IGN1c3RvbU1lbnVzLAogICAgICB9OwogICAgfQoKICAgIG1ha2VNZW51KCkgeyBpbml0TWVudU1ha2VyKCkgfQoKICAgIHJlbW92ZUV4dCgpIHsKICAgICAgZXh0UmV2bW92YWJsZSA9IHRydWU7CiAgICAgIGNvbnN0IGRlbGV0ZUJsb2NrID0gKHRhcmdldCwgYmxvY2tJZCkgPT4gewogICAgICAgIGlmICh0YXJnZXQgPT09IHZtLmVkaXRpbmdUYXJnZXQgJiYgU2NyYXRjaC5ndWkpIFNjcmF0Y2guZ3VpLmdldEJsb2NrbHkoKS50aGVuKFNCID0+IFNCLmdldE1haW5Xb3Jrc3BhY2UoKS5nZXRCbG9ja0J5SWQoYmxvY2tJZCk/LmRpc3Bvc2UodHJ1ZSwgZmFsc2UpKTsKICAgICAgICBlbHNlIHRhcmdldC5ibG9ja3MuZGVsZXRlQmxvY2soYmxvY2tJZCk7CiAgICAgIH07CiAgICAgIGN1c3RvbU1lbnVzID0ge307CiAgICAgIG1lbnVzWE1MID0gYDxsYWJlbCB0ZXh0PSJUcnkgY3JlYXRpbmcgc29tZSBtZW51cyEiIC8+YDsKICAgICAgZm9yIChjb25zdCB0YXJnZXQgb2YgcnVudGltZS50YXJnZXRzKSB7CiAgICAgICAgZm9yIChjb25zdCBibG9jayBvZiBPYmplY3QudmFsdWVzKHRhcmdldC5ibG9ja3MuX2Jsb2NrcykpIHsKICAgICAgICAgIGlmIChibG9jay5vcGNvZGUuc3RhcnRzV2l0aCgiU1Awek1lbnVNYWtlcl8iKSkgZGVsZXRlQmxvY2sodGFyZ2V0LCBibG9jay5pZCk7CiAgICAgICAgfQogICAgICB9CiAgICAgIHZtLmV4dGVuc2lvbk1hbmFnZXIucmVmcmVzaEJsb2NrcygpOwogICAgICBhbGVydCgiU2F2ZSBhbmQgcmVsb2FkIHRoZSBwcm9qZWN0IGZvciB0aGUgZXh0ZW5zaW9uIHRvIGZ1bGx5IGJlIHJlbW92ZWQuIik7CiAgICB9CgogICAgaW1wb3J0TWVudXMoYXJncykgewogICAgICB0cnkgewogICAgICAgIGNvbnN0IG1lbnVzID0gSlNPTi5wYXJzZShhcmdzLk1FTlVTKTsKICAgICAgICBpZiAodHlwZW9mIG1lbnVzICE9PSAib2JqZWN0IiB8fCBtZW51cyA9PT0gbnVsbCB8fCBBcnJheS5pc0FycmF5KG1lbnVzKSkgcmV0dXJuIGFsZXJ0KCJJbXBvcnRlZCBKU09OIE11c3QgYmUgYW4gT2JqZWN0Iik7CiAgICAgICAgZm9yIChjb25zdCBrZXkgaW4gbWVudXMpIHsKICAgICAgICAgIGlmIChoYXNPd24obWVudXMsIGtleSkpIHsKICAgICAgICAgICAgY29uc3QgaW5uZXJPYmplY3QgPSBtZW51c1trZXldOwogICAgICAgICAgICBpZiAoIWhhc093bihpbm5lck9iamVjdCwgIml0ZW1zIikpIHJldHVybiBhbGVydChgJHtrZXl9IE1lbnUgTmVlZHMgYW4gIml0ZW1zIiBLZXlgKTsKICAgICAgICAgICAgZm9yIChjb25zdCBpbm5lcktleSBpbiBpbm5lck9iamVjdCkgewogICAgICAgICAgICAgIGlmIChoYXNPd24oaW5uZXJPYmplY3QsIGlubmVyS2V5KSAmJiBpbm5lcktleSAhPT0gIml0ZW1zIikgZGVsZXRlIGlubmVyT2JqZWN0W2lubmVyS2V5XTsKICAgICAgICAgICAgfQogICAgICAgICAgICBtZW51c1trZXldLmFjY2VwdFJlcG9ydGVycyA9IGZhbHNlOwogICAgICAgICAgICBjb25zdCBpdGVtcyA9IGlubmVyT2JqZWN0Lml0ZW1zOwogICAgICAgICAgICBpZiAoIUFycmF5LmlzQXJyYXkoaXRlbXMpKSByZXR1cm4gYWxlcnQoYCJpdGVtcyIga2V5IGluICR7a2V5fSBNZW51IE11c3QgYmUgYW4gQXJyYXlgKTsKICAgICAgICAgICAgaWYgKGl0ZW1zLmxlbmd0aCA9PT0gMCkgcmV0dXJuIGFsZXJ0KGAiaXRlbXMiIGtleSBpbiAke2tleX0gTWVudSBNdXN0IGhhdmUgYXQgTGVhc3QgMSBJdGVtYCk7CiAgICAgICAgICAgIGZvciAoY29uc3QgaXRlbSBvZiBpdGVtcykgewogICAgICAgICAgICAgIGlmICh0eXBlb2YgaXRlbSAhPT0gIm9iamVjdCIgfHwgaXRlbSA9PT0gbnVsbCB8fCBBcnJheS5pc0FycmF5KGl0ZW0pKSByZXR1cm4gYWxlcnQoYGl0ZW1zIGluICJpdGVtcyIga2V5IGluICR7a2V5fSBNZW51IE11c3QgYmUgT2JqZWN0c2ApOwogICAgICAgICAgICAgIGNvbnN0IGtleXMgPSBPYmplY3Qua2V5cyhpdGVtKTsKICAgICAgICAgICAgICBpZiAoa2V5cy5sZW5ndGggIT09IDIgfHwgIWtleXMuaW5jbHVkZXMoInRleHQiKSB8fCAha2V5cy5pbmNsdWRlcygidmFsdWUiKSkgcmV0dXJuIGFsZXJ0KGBpdGVtcyBpbiAiaXRlbXMiIGtleSBpbiAke2tleX0gTWVudSBNdXN0IGhhdmUgMiBrZXlzLCAidGV4dCIgYW5kICJ2YWx1ZSJgKTsKICAgICAgICAgICAgICBpZiAodHlwZW9mIGl0ZW0udGV4dCAhPT0gInN0cmluZyIgfHwgdHlwZW9mIGl0ZW0udmFsdWUgIT09ICJzdHJpbmciKSByZXR1cm4gYWxlcnQoYCJpdGVtIiB2YWx1ZXMgaW4gJHtrZXl9IE1lbnUgTXVzdCBiZSBTdHJpbmdzYCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgY3VzdG9tTWVudXMgPSBtZW51czsKICAgICAgICByZWZyZXNoTWFnaWMoKTsKICAgICAgICAvLyBSZW1vdmUgTWVudSBCbG9ja3MgdGhhdCBubyBMb25nZXIgRXhpc3QKICAgICAgICBjb25zdCBhbGxCbG9ja3MgPSBTY3JhdGNoQmxvY2tzLm1haW5Xb3Jrc3BhY2UuYmxvY2tEQl87CiAgICAgICAgY29uc3QgbWVudU5hbWVzID0gT2JqZWN0LmtleXMoY3VzdG9tTWVudXMpOwogICAgICAgIGZvciAoY29uc3QgW2tleSwgYmxvY2tdIG9mIE9iamVjdC5lbnRyaWVzKGFsbEJsb2NrcykpIHsKICAJICAgICAgaWYgKGJsb2NrLnR5cGUuc3RhcnRzV2l0aCgiU1Awek1lbnVNYWtlcl9tZW51XyIpKSB7CiAgCSAgICAgCSAgaWYgKG1lbnVOYW1lcy5pbmRleE9mKGJsb2NrLnR5cGUucmVwbGFjZSgiU1Awek1lbnVNYWtlcl9tZW51XyIsICIiKSkgPT09IC0xKSBibG9jay5kaXNwb3NlKCk7CiAgCSAgICAgIH0KCQkgICAgfQogICAgICB9IGNhdGNoIHsgYWxlcnQoIkNvdWxkbnQgUGFyc2UgSW1wb3J0ZWQgQ3VzdG9tIE1lbnUgSlNPTiIpIH0KICAgIH0KCiAgICBleHBvcnRNZW51cygpIHsgcmV0dXJuIEpTT04uc3RyaW5naWZ5KGN1c3RvbU1lbnVzKSB9CgogICAgLy8gUGVuZ3Vpbk1vZCArIEludGVybWVkaWFyeVRXIFN0b3JhZ2UKICAgIHNlcmlhbGl6ZSgpIHsgcmV0dXJuIHsgU1Awek1lbnVNYWtlciA6IHsgbWVudXMgOiBjdXN0b21NZW51cyB9IH0gfQogICAgZGVzZXJpYWxpemUoZGF0YSkgewogICAgICBpZiAoZGF0YS5TUDB6TWVudU1ha2VyICE9PSB1bmRlZmluZWQpIGN1c3RvbU1lbnVzID0gZGF0YS5TUDB6TWVudU1ha2VyLm1lbnVzOwogICAgICBlbHNlIHN0YXJ0TGlzdGVuZXJXb3JrZXIoKTsKICAgICAgdGhpcy5uZWVkc1JlZnJlc2ggPSB0cnVlOwogICAgfQogIH0KICBTY3JhdGNoLmV4dGVuc2lvbnMucmVnaXN0ZXIoKGV4dGVuc2lvbkluc3RhbmNlID0gbmV3IFNQMHpNZW51TWFrZXIoKSkpOwogIGlmIChpc1BNICYmIHR5cGVvZiBzY2FmZm9sZGluZyA9PT0gInVuZGVmaW5lZCIpIHsKICAgIHJlZnJlc2hNYWdpYygpOwogICAgc3RhcnRMaXN0ZW5lcldvcmtlcigpOwogIH0KfSkoU2NyYXRjaCk7Cg==","https://extensions.turbowarp.org/text.js","https://extensions.turbowarp.org/stretch.js","https://extensions.turbowarp.org/godslayerakp/http.js","https://extensions.turbowarp.org/files.js","https://extensions.turbowarp.org/Lily/ClonesPlus.js","https://extensions.turbowarp.org/Lily/lmsutils.js","https://extensions.turbowarp.org/Lily/Skins.js","https://extensions.turbowarp.org/navigator.js","https://extensions.turbowarp.org/Lily/Video.js","https://extensions.turbowarp.org/Lily/CommentBlocks.js","https://extensions.turbowarp.org/Lily/TempVariables2.js","https://extensions.turbowarp.org/fetch.js","https://extensions.turbowarp.org/sound.js","https://extensions.turbowarp.org/numerical-encoding-2.js","https://extensions.turbowarp.org/DNin/wake-lock.js","https://extensions.turbowarp.org/CST1229/zip.js","https://extensions.turbowarp.org/true-fantom/network.js","https://extensions.penguinmod.com/extensions/jwklong/mathematics.js","https://extensions.turbowarp.org/Lily/LooksPlus.js","https://extensions.turbowarp.org/ZXMushroom63/searchApi.js","https://extensions.turbowarp.org/Lily/MoreEvents.js","https://extensions.turbowarp.org/Skyhigh173/json.js","https://sharkpools-extensions.vercel.app/extension-code/Extra-Controls.js","https://sharkpools-extensions.vercel.app/extension-code/Files-Expanded.js","https://extensions.turbowarp.org/-SIPC-/time.js","https://extensions.turbowarp.org/local-storage.js","https://extensions.turbowarp.org/XeroName/Deltatime.js","https://extensions.turbowarp.org/cursor.js","https://extensions.turbowarp.org/DT/cameracontrols.js","https://extensions.penguinmod.com/extensions/skyhigh173/object.js","https://sharkpools-extensions.vercel.app/extension-code/My-Blocks-Plus.js","https://sharkpools-extensions.vercel.app/extension-code/Variables-Expanded.js","https://sharkpools-extensions.vercel.app/extension-code/Fetch-Progress.js","https://sharkpools-extensions.vercel.app/extension-code/Better-Input.js","https://sharkpools-extensions.vercel.app/extension-code/Hyper-Sense.js","https://sharkpools-extensions.vercel.app/extension-code/Particle-Engine.js","https://sharkpools-extensions.vercel.app/extension-code/Time-Calculation.js","https://extensions.penguinmod.com/extensions/Lily/AllMenus.js","https://extensions.penguinmod.com/extensions/SharkPool/Sprite-Effects.js","https://sharkpools-extensions.vercel.app/extension-code/Layer-Control.js"],"bakeExtensions":true,"maxTextureDimension":2048}